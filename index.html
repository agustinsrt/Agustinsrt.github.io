<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Repair Evaluator</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
  <script src="script.js"></script>
</head>
<body>

  <div class="floating-menu">
    <button class="orange">Resources</button>
    <div class="dropdown-content">
      <a href="#" onclick="openPopup('tax_exemptions.html', 'Tax Ex')">Tax Exemptions</a>
      <a href="#" onclick="openPopup('extended_coverage.html', 'MFG Extended Coverage')">MFG Extended Coverage</a>
      <a href="#" onclick="openPopup('email_templates.html', 'Email Templates')">Email Templates</a>
      <a href="#" onclick="openPopup('state_abbreviations.html', 'State Abbreviations')">State Abbreviations</a>
      <a href="#" onclick="openPopup('phone_directory.html', 'Phone Directory')">Phone Directory</a>
      <a href="#" onclick="openPopup('calculator.html', 'Calculator')">Calculator</a>
      
      <!-- Menú Secundario -->
      <div class="dropdown-submenu">
        <a href="#">External Sites ▸</a>
        <div class="submenu-content">
          <a href="https://www.encompass.com" target="_blank">Encompass</a>
          <a href="https://my.servicepower.com/" target="_blank">Service Power</a>
          <a href="https://app.smartsheet.com/b/home?dlp=%2Fsheets%2FMrcwvQwxjwxgrRpJcwGqQVGqHxjgw5c8H9fgfXv1&dlq=view%3Dgrid" target="_blank">Claims Smartsheet</a>
          <a href="https://app.smartsheet.com/sheets/mH8xqc99V2w7jrMRMXqhPJjM5jfjjcr4hjwfh431" target="_blank">RFA Smartsheet</a>
        </div>
      </div>
    </div>
  </div>
    

  
  
    </div>
  </div>
  
  

  <div class="container">
    <h2>Repair Evaluator</h2>

    <!-- Authorization Number -->
    
    <div class="compact flex">
      <label for="authNumber">Authorization :</label>
      <input type="text" id="authNumber" placeholder="Enter Authorization Number" maxlength="13" oninput="formatAuthNumber()" style="width: 200px">

      <button class="orange" onclick="openContract()">T&C</button>
    </div>
    

    <!-- General Inputs -->
    <div class="compact flex">
      <label for="svcName">SVC Name:</label>
      <input type="text" id="svcName" placeholder="Enter SVC Name">
    </div>

    <div class="compact flex">
      <label for="model" >Model:</label>
      <input type="text" id="model" placeholder="Enter Model" style="width: 200px">
      <button class="orange" onclick="searchModel()">Search</button>
    </div>

    <div class="compact flex" style="margin-bottom: 10px;">
      <label for="serial">Serial:</label>
      <input type="text" id="serial" placeholder="Enter Serial" style="width: 200px">
    </div>

    <div class="compact"  style="margin-bottom: 10px;">
      <label>Physical Damage:</label>
      <input type="radio" name="physicalDamage" value="yes"> Yes
      <input type="radio" name="physicalDamage" value="no"> No
    </div>

    <div class="compact">
      <label for="complaint">Complaint:</label>
      <textarea id="complaint" style="width: 100%; height: 50px;" placeholder="Describe the complaint"></textarea>
    </div>

    <div class="compact">
      <label for="techDiag">Tech's Diag:</label>
      <textarea id="techDiag" style="width: 100%; height: 75px;" placeholder="Enter tech's diagnosis"></textarea>
    </div>

    <!-- Actions Section --> 
    <div class="actions">
          </div>
        <!-- SVC Section -->
<h3>SVC Estimate</h3>

<div style="margin-bottom: 10px;">
  <label for="laborCost" style="min-width: 100px;">Labor Cost:</label>
  <input type="number" id="laborCost" placeholder="Enter labor cost" style="width: 150px" oninput="updateTotals()" min="0">
</div>

<div style="margin-bottom: 10px;">
  <label for="mileageCost" style="min-width: 100px;">Mileage Cost:</label>
  <input type="number" id="mileageCost" maxlength="12" placeholder="Enter mileage cost" style="width: 150px" oninput="updateTotals()" min="0">
  <label style="margin-left: 10px;">
    <input type="checkbox" id="noMileage" checked onchange="toggleField('mileageCost', 'noMileage')"> No Mileage
  </label>
</div>

<div style="margin-bottom: 10px;">
  <label for="rrCost" style="min-width: 100px;">R&R:</label>
  <input type="number" id="rrCost" maxlength="12" placeholder="Enter R&R cost" style="width: 150px" oninput="updateTotals()" min="0">
  <label style="margin-left: 10px;">
    <input type="checkbox" id="noRR" checked onchange="toggleField('rrCost', 'noRR')"> No R&R
  </label>
</div>


<div style="display: flex; gap: 10px; align-items: center;">
  <button class="orange" onclick="addRow('svc')">Add SVC Part</button>
  <button class="orange" onclick="addSVCTaxes()">Add Taxes</button> <!-- Botón agregado -->
  <button class="orange" onclick="window.open('TAX EX.PNG', '_blank', 'width=800,height=600')">View Tax Exemptions</button>
</div>

<table id="svcTable">
  <thead>
    <tr>
      <th>Part Cost</th>
      <th>Qty</th>
      <th>Total Cost</th>
      <th>Part Number</th>
      <th>Part Name</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><input type="number" placeholder="Cost" style="width: 90%;" oninput="updateTotals()" min="0"></td>
      <td><input type="number" placeholder="Qty" style="width: 50px;" oninput="updateTotals()" min="1" max="99" value="1"></td>
      <td><input type="number" placeholder="Total Cost" style="width: 90%;" readonly></td>
      <td><input type="text" placeholder="Number" style="width: 90%;"></td>
      <td><input type="text" placeholder="Name" style="width: 90%;"></td>
      <td style="display: flex; gap: 5px; justify-content: flex-start;">
        <button class="orange" onclick="searchEncompass(this)">Encompass</button>
        <button class="dark-gray" onclick="deleteRow(this)">Delete</button>
      </td>
    </tr>
  </tbody>
</table>

<p class="subtotal" id="svcSubtotal">$0.00   SVC TOTAL <span id="svcPartsBreakdown">($0.00 parts)</span></p>
<!-- CTR Section -->
<h3>CTR Estimate</h3>
<div style="display: flex; gap: 10px; align-items: center;">
    <button class="orange" onclick="addRow('ctr')">Add CTR Part</button>
    <button class="orange" onclick="addShippingHandling()">Add S&H</button>
    <button class="orange" onclick="addTaxes()">Add Taxes</button> <!-- Botón de Taxes -->
</div>
<table id="ctrTable">
  <thead>
    <tr>
      <th>Part Cost</th>
      <th>Qty</th>
      <th>Total Cost</th>
      <th>Part Number</th>
      <th>Part Name</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <!-- Aquí se agregarán las filas dinámicamente -->
  </tbody>
</table>
<p class="subtotal" id="ctrSubtotal">$0.00   CTR TOTAL <span id="ctrPartsBreakdown">($0.00 parts)</span></p>

        <!-- LOL Section -->
<div class="compact">
  <label>LOL:</label>
  <input type="radio" name="lolType" value="FV"> FV
  <input type="radio" name="lolType" value="FV-C"> FV-C
</div>

<div class="compact">
  <label for="applianceValue">LOL $ :</label>
  <input type="number" id="applianceValue" placeholder="Enter appliance value" aria-label="Enter the appliance value" min="0" oninput="updateRepairPercentageWithLOL()">
</div>

<div class="compact">
  <label for="previousClaims">Previous Claims:</label>
  <input type="number" id="previousClaims" placeholder="Enter previous claims" 
         aria-label="Enter the number of previous claims" min="0" step="0.01" 
         value="" oninput="updateRepairPercentageWithLOL()">
</div>

<div class="compact" style="display: flex; align-items: center; gap: 10px;">
  <label>% Repairs:</label>
  <p id="repairResults" style="margin: 0;"></p>
</div>

<div class="compact">
  <label for="expirationDate">Expiration Date:</label>
  <input type="text" id="expirationDate" placeholder="MMDDYY" maxlength="8" oninput="formatExpirationDate()" style="width: 100px;">
  <p id="remainingMonths" style="white-space: nowrap; width: 100px; margin: 0;"></p>
</div>

<!-- MFG Coverage -->
<div class="compact"  style="margin-top: 10px;">
  <label for="mfgCoverage">MFG Coverage:</label>
  <input type="checkbox" id="noMfgCoverage" onchange="toggleField('mfgCoverage', 'noMfgCoverage')"> No Additional MFG Coverage
</div>
<textarea id="mfgCoverage" style="height: 60px; width: 100%" placeholder="Enter additional mfg coverage"></textarea>



<!-- Button to calculate LOL percentage -->
<div class="compact">
  <button class="orange" onclick="calculateLOLPercentage()">Calculate LOL %</button> <button class="orange" class="orange" onclick="sendCompQuoteEmail()" style="margin-top: 20px;">Request Comp Quote</button> <label for="svcEmail">SVC Email:</label>
  <input type="email" id="svcEmail" placeholder="Enter SVC email" style="width: 185px">
</div>

<!-- Results Section -->
<div id="lolResults" style="margin-top: 20px;">
  <!-- Results for LOL Percentage and recommendations will appear here -->
</div>
           
                                
          <!-- Final Recommendation -->
          <h3>Final Recommendation</h3>
          <textarea id="finalRecommendation" style="height: 100px; width: 100%" placeholder="Enter final recommendation"></textarea>
      
          <!-- Show Results -->
          <h3>Results</h3>
          <button class="orange" onclick="showResults()">Show Results</button>
          <textarea id="results" style="width: 100%; border: 1px solid #ccc; padding: 10px;"></textarea>

                             <!-- Botón para copiar al portapapeles -->

                             <button id="copyButton" class="orange" onclick="copyToClipboard()">Copy to Clipboard</button>

<button class="orange" id="saveToLogButton">Save and New</button>
<span id="saveConfirmation" style="display: none; color: green; margin-left: 10px;">Saved!</span>
<button class="orange" id="downloadLogButton">Download Log</button>
<button class="orange" id="openLogButton">Open Log</button>
<button class="orange" id="copyTableButton">Copy to RFA SS </button>
</div>

<!-- Tabla oculta para almacenar los datos -->
<table id="dataTable" style="display: none;">
<thead>
    <tr>
        <th>SP Number RFA</th>
        <th>Date RFA Submitted</th>
        <th>Date Assigned to Agent</th>
        <th>Agent Name</th>
        <th>Status</th>
        <th>Authorization</th>
        <th>Current Date</th>
        <th>SVC Name</th>
        <th>Comments</th>
        <th>Req Comp</th>
        <th>Date Completed</th>
        <th>Push Back</th>
        <th>Reason</th>
        <th>Times Push Back</th>
        <th>SVC Cost</th>
        <th>CTR Cost</th>
        <th>Difference</th>
        <th>Amount Approved</th>
        <th>Done</th>
    </tr>
</thead>
<tbody>
    <!-- Aquí se agregarán las filas dinámicamente -->
</tbody>
</table>
    </body>
    </html>                                